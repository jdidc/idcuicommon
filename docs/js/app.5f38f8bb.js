(function(t){function e(e){for(var r,u,i=e[0],s=e[1],c=e[2],l=0,f=[];l<i.length;l++)u=i[l],o[u]&&f.push(o[u][0]),o[u]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);p&&p(e);while(f.length)f.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,u=1;u<n.length;u++){var s=n[u];0!==o[s]&&(r=!1)}r&&(a.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},o={app:0},a=[];function u(t){return i.p+"js/"+({}[t]||t)+"."+{"chunk-2d0bd1c6":"612f2d5e","chunk-9426ab02":"8d3cc121"}[t]+".js"}function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(t){var e=[],n=o[t];if(0!==n)if(n)e.push(n[2]);else{var r=new Promise(function(e,r){n=o[t]=[e,r]});e.push(n[2]=r);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=u(t),a=function(e){s.onerror=s.onload=null,clearTimeout(c);var n=o[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src,u=new Error("Loading chunk "+t+" failed.\n("+r+": "+a+")");u.type=r,u.request=a,n[1](u)}o[t]=void 0}};var c=setTimeout(function(){a({type:"timeout",target:s})},12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(e)},i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/idcuicommon/",i.oe=function(t){throw console.error(t),t};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var p=c;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"06f9":function(t,e,n){var r=n("bae2");"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var o=n("499e").default;o("5c093dc8",r,!0,{sourceMap:!1,shadowMode:!1})},"36ae":function(t,e,n){var r=n("70ca");"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var o=n("499e").default;o("46c2ff3b",r,!0,{sourceMap:!1,shadowMode:!1})},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-link",{attrs:{to:"/export-button"}},[t._v("export-button")]),n("div",{staticClass:"main"},[n("router-view")],1)],1)},a=[],u={name:"app"},i=u,s=(n("5c0b"),n("2877")),c=Object(s["a"])(i,o,a,!1,null,null,null),l=c.exports,p=n("e069"),f=n.n(p),d=(n("dcad"),n("cebc")),h=n("a4bb"),b=n.n(h),m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"button-wrapper",on:{click:t.setTotal}},[t._t("default",[n("Button",{attrs:{loading:t.loading,disabled:t.disabled,icon:"md-download",type:"primary"}},[t._v(t._s(t.title))])]),t.modal?n("processModal",{attrs:{currentNumber:t.currentNumber,exporting:t.exporting,percent:t.percent,total:t.cloneTotal},on:{startExport:t.startExport},model:{value:t.processModalShow,callback:function(e){t.processModalShow=e},expression:"processModalShow"}}):t._e()],2)},v=[],x=n("75fc"),g=n("795b"),y=n.n(g),w=(n("96cf"),n("3b8d")),_=(n("c5f6"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Modal",{attrs:{"mask-closable":!1,title:t.modalTitle},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("div",{staticClass:"content"},[n("div",{staticClass:"number"},[n("span",{staticClass:"number-first"},[t._v(t._s(t.currentNumber))]),n("span",{staticClass:"number-op"},[t._v("/")]),n("span",{staticClass:"number-total"},[t._v(t._s(t.total))])]),n("Progress",{attrs:{percent:t._f("numberFormat")(t.percent)}})],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{loading:t.exporting,type:"primary"},on:{click:t.startExport}},[t._v(t._s(t.buttonName))])],1)])}),k=[],T={props:{value:Boolean,total:Number,percent:Number,exporting:Boolean,currentNumber:Number,modalTitle:{type:String,default:function(){return"数据导出"}}},data:function(){return{show:!1}},computed:{buttonName:function(){return 0===this.currentNumber?"开始导出":this.currentNumber<this.total?"数据获取中":"以获取，正在下载"}},methods:{startExport:function(){this.$emit("startExport")}},watch:{show:function(t){this.$emit("input",t)},value:function(t){this.show=t}},filters:{numberFormat:function(t){return Number(t.toFixed(2))}}},M=T,S=(n("917f"),Object(s["a"])(M,_,k,!1,null,"09bdc70b",null)),j=S.exports,N={name:"ExportButton",components:{processModal:j},props:{request:{type:Function,required:!1},total:{type:Number,default:function(){return 0}},getTotal:Function,pageSize:{default:100,type:Number},loading:{type:Boolean,default:function(){return!1}},disabled:{type:Boolean,default:function(){return!1}},modal:{type:Boolean,default:function(){return!0}},data:{type:Array,default:function(){return[]}},filename:{type:String,default:function(){return"导出文件"}},title:{type:String,default:"数据导出"},columns:{type:Array,required:!0},autoWidth:{type:Boolean,default:function(){return!0}},bookType:{type:String,default:function(){return"xlsx"}}},data:function(){return{cloneTotal:0,percent:0,currentNumber:0,processModalShow:!1,exporting:!1}},methods:{setTotal:function(){var t=Object(w["a"])(regeneratorRuntime.mark(function t(){var e,r,o,a,u;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!this.loading&&!this.disabled){t.next=2;break}return t.abrupt("return");case 2:if(!(this.data.length>0)){t.next=13;break}return t.next=5,n.e("chunk-9426ab02").then(n.bind(null,"ee30"));case 5:e=t.sent,r=[],o=[],this.columns.forEach(function(t){r.push(t.title),o.push(t.key)}),a=this.formatJson(o,this.data),e.export_json_to_excel({multiHeader:[],header:r,data:a,merges:[],filename:this.filename,autoWidth:this.autoWidth,bookType:this.bookType}),t.next=24;break;case 13:if(!(this.total>0)){t.next=18;break}this.cloneTotal=this.total,this.processModalShow=!0,t.next=24;break;case 18:return this.reset(),t.next=21,this.getTotal();case 21:u=t.sent,this.cloneTotal=u,this.processModalShow=!0;case 24:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getData:function(t){var e=this;return new y.a(function(n){var r=[],o=0,a=e;function u(){a.exporting||(a.exporting=!0),a.request(o,a.pageSize).then(function(e){if(a.addPercent(),o++,r.push.apply(r,Object(x["a"])(e)),a.currentNumber=r.length,!(o>=t))return u();n(r)})}u()})},startExport:function(){var t=Object(w["a"])(regeneratorRuntime.mark(function t(){var e,r,o,a,u,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=Math.ceil(this.cloneTotal/this.pageSize),t.next=3,this.getData(e);case 3:return r=t.sent,t.next=6,n.e("chunk-9426ab02").then(n.bind(null,"ee30"));case 6:o=t.sent,a=[],u=[],this.columns.forEach(function(t){a.push(t.title),u.push(t.key)}),r=this.formatJson(u,r),o.export_json_to_excel({multiHeader:[],header:a,data:r,merges:[],filename:this.filename,autoWidth:this.autoWidth,bookType:"xlsx"}),setTimeout(function(){i.processModalShow=!1,i.exporting=!1},1e3);case 13:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),formatJson:function(t,e){return e.map(function(e){return t.map(function(t){return e[t]})})},addPercent:function(){var t=100/Math.ceil(this.cloneTotal/this.pageSize);this.percent+=t},reset:function(){this.cloneTotal=0,this.percent=0,this.currentNumber=0}}},E=N,O=(n("e9eb"),Object(s["a"])(E,m,v,!1,null,"6c0f40f5",null)),P=O.exports,B=P,C={ExportButton:B},$=function(t){b()(C).forEach(function(e){t.component(e,C[e])})},q=Object(d["a"])({install:$},C),z=n("8c4f");r["default"].use(f.a),r["default"].use(q),r["default"].use(z["a"]);var F=new z["a"]({routes:[{path:"/export-button",component:function(){return n.e("chunk-2d0bd1c6").then(n.bind(null,"2b33"))}}]});r["default"].config.productionTip=!1,new r["default"]({router:F,render:function(t){return t(l)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var r=n("e959"),o=n.n(r);o.a},"70ca":function(t,e,n){e=t.exports=n("2350")(!1),e.push([t.i,".button-wrapper[data-v-6c0f40f5]{display:inline-block}",""])},"917f":function(t,e,n){"use strict";var r=n("06f9"),o=n.n(r);o.a},a33e:function(t,e,n){e=t.exports=n("2350")(!1),e.push([t.i,".main{margin:20px}",""])},bae2:function(t,e,n){e=t.exports=n("2350")(!1),e.push([t.i,".content[data-v-09bdc70b]{text-align:center}.number[data-v-09bdc70b]{font-size:28px}",""])},e959:function(t,e,n){var r=n("a33e");"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var o=n("499e").default;o("6f19147e",r,!0,{sourceMap:!1,shadowMode:!1})},e9eb:function(t,e,n){"use strict";var r=n("36ae"),o=n.n(r);o.a}});
//# sourceMappingURL=app.5f38f8bb.js.map